
\section{Risposta ai segnali canonici}
Ci si riferirà principalmente alla risposta al gradino e all'impulso, facendo
uso della funzione di trasferimento presentata nella sezione precedente.
Si esegue inizialmente un'analisi di tipo ``asintotico'', per $t\to \infty$,
successivamente per $t\to 0$. Questo tipo di risposta non richiede l'analisi
puntuale delle equazioni del sistema, è necessario analizzare alcune
caratteristiche della funzione di trasferimento.

La risposta all'impulso è per definizione l'antitrasformata della funzione di
trasferimento
$$
W(t) = \Lap^{-1} [W(s)]
$$
Sviluppati i fratti, la funzione avrà la seguente forma
$$
W(t) = \Lap^{-1}\left[\frac{R_0}{s} + \frac{R_1}{s^2} +\ldots +
\frac{R_{g-1}}{s^g} + \frac{p_1}{s-p_1} + \frac{p_2}{s-p_2} + \ldots \right]
$$
I primi fratti (fino a $R_{g-1}$) sono associati ai poli nell'origine, seguono
i fratti associati ai poli reali ($p_i$) o eventualmente complessi e coniugati.

Il valore di $g$ permette di capire il tipo di sistema e se positivo, il numero
di poli nell'origine.
L'antitrasformata del primo termine è un gradino, del secondo è una retta, poi
una parabola e così via.
Tutti questi segnali (eccetto il primo che resta costante) divergeranno per
$t\to \infty$.

Si analizzano gli altri poli, se ne esiste almeno uno con parte reale positiva,
si avrà un esponenziale divergente nell'antitrasformata, se invece sono tutti a
parte reale negativa la loro somma convergerà.
$$\left\{
\begin{aligned}
\exists p_i &: \Re(p_i) > 0 \Rightarrow \text{Divergono} \\
\forall p_i &: \Re(p_i) < 0 \Rightarrow \text{Convergono} \\
\forall p_i &: \Re(p_i) < 0 \text{ e qualcuno sull'asse } \Im\ (m_a=1)
\end{aligned}\right.
$$
Il terzo caso prevede la presenza di poli a parte reale negativa più
qualcuno sull'asse immaginario, a parte reale
nulla ma con molteplicità algebrica pari ad uno, in questo caso si ha una
permanenza dell'uscita. Se invece la molteplicità algebrica degli autovalori a
parte reale nulla è maggiore di uno il sistema diverge.

Un sistema è \textbf{asintoticamente stabile} se e soltanto se
$$
\lim_{t\to +\infty} W(t) = 0
$$
ciò è garantito solo se \textit{tutti} i poli hanno parte reale negativa.

\newpage
\subsection{Poli dominanti}
Sono i poli con parte reale massima, origine dei modi che perdurano per più
tempo.
Si ipotizza che il sistema sia asintoticamente stabile, tutti i poli sono
contenuti nel semipiano sinistro.

Si supponga che il polo dominante sia \textit{reale}, asintoticamente il
comportamento è simile ad un sistema del primo ordine. Dopo un tempo pari a tre
o quattro volte la costante di tempo del polo dominante è indifferente
considerare solo la funzione associata a quel polo o l'intera funzione di
trasferimento.
$$
W(s) = K_B \frac{\prod_i (1+s\tau_{zi})
\prod_i\left(1+\frac{2\zeta_{zi}}{\omega_{nzi}}s + \frac{s^2}{\omega_{nzi}^2}
\right)}{ \prod_i (1+s\tau_{pi})
\prod_i\left(1+\frac{2\zeta_{pi}}{\omega_{npi}}s + \frac{s^2}{\omega_{npi}^2}
\right)  }
$$
Il tipo $g$, in un sistema asintoticamente stabile, può essere negativo o al
più pari a zero. Per $t \to \infty, s\to 0$ la funzione di
trasferimento tende inizialmente a
$$W(s)=K_B\frac{1}{1+s\tau_{pj}}$$
con $\tau_{pj}$ la
costante di tempo dominante associata al polo $j$-esimo. La semplificazione va
eseguita nella forma di \textit{Bode} e va preservato il guadagno statico, non
è possibile eseguirla nella forma di \textit{Evans}.


Si supponga che i poli dominanti siano una coppia di poli complessi e coniugati.
In questo caso il termine residuo sarebbe
$$
W(s)=K_B \frac{1}{1+\frac{2\zeta_{pi}}{\omega_{npi}}s +
\frac{s^2}{\omega_{npi}^2}
}
$$

Si considereranno dunque due tipi di sistemi, sistemi del primo ordine o
sistemi del secondo ordine.
\newpage
\subsubsection{Sistema del primo ordine}
Sia il seguente sistema con funzione di trasferimento del primo ordine, si
studia la risposta all'impulso come antitrasformata della funzione di
trasferimento
$$
W(s) = K_B \frac{1}{1+s\tau} \stackrel{\Lap^{-1}}{\longrightarrow} W(t) = K_B
e^{-\frac{t}{\tau}}\cdot \delta_{-1}(t)
$$
\begin{figure}[h]
 \centering
 \begin{tikzpicture}
  \begin{axis}[
   width = 0.4\linewidth,
   axis lines = left,
   ylabel={$W(t)$},
   xlabel={$t$},
   xtick={0,1},
   xticklabels={,$\tau$},
   ytick={1},
   yticklabels={$K_B$},
   xlabel style={at={(ticklabel* cs:1)},anchor=north},
   ylabel style={at={(ticklabel* cs:1)},anchor= east,rotate=-90},
   ymax=1.3,
   ymin=0,
   ]
   \addplot[domain=0:3]{exp{-x}};
   \addplot[domain=0:1]{1-x};
\addplot [draw=none,pattern = north east lines, pattern color=red,
] coordinates {
    (0, 1.4)
    (0, 0)
    (0.5, 0)
    (0.5, 1.4)
};
  \end{axis}
 \end{tikzpicture}
\end{figure}
Questa soluzione vale per i sistemi del primo ordine e anche per quelli che si
approssimano per $t>\tau_{\text{max}}$ a sistemi del primo ordine, nel secondo
caso però le soluzioni per $t<\tau$ devono essere verificate rispetto alle
altre costanti di tempo del sistema.

Si analizza la risposta al gradino
$$
u(t) = \delta_{-1}(t) \longrightarrow Y_f(s) = \frac{W(s)}{s} =
\frac{K_b}{s(1+s\tau)}
$$
antitrasformando si ottiene la risposta al gradino chiamata anche risposta
\textit{indiciale}.
$$\begin{aligned}
W_{-1}(t) &= \Lap{-1}
\left[\frac{K_B}{\tau}\left(\frac{R_0}{s}+\frac{R_1}{s+\frac{1}{\tau}}
\right)\right] = \Lap{-1}
\left[\frac{K_B}{\tau}\left(\frac{\tau}{s}+\frac{-\tau}{s+\frac{1}{\tau}}
\right)\right] = \\
&=K_B\left(1-e^{-\frac{t}{\tau}} \right)\delta_{-1}(t)
\end{aligned}$$
\begin{figure}[h]
 \centering
 \begin{tikzpicture}
  \begin{axis}[
   width = 0.4\linewidth,
   axis lines = left,
   ylabel={$W_{-1}(t)$},
   xlabel={$t$},
   xtick={0,1},
   xticklabels={,$\tau$},
   ytick={1},
   yticklabels={$K_B$},
   xlabel style={at={(ticklabel* cs:1)},anchor=north},
   ylabel style={at={(ticklabel* cs:1)},anchor= east,rotate=-90},
   ymax=1.3,
   ymin=0,
   ]
   \addplot[domain=0:3]{1-exp{-x}};
   \addplot[domain=0:1]{x};
   \addplot[dashed,domain=0:3]{1};
   \addplot[dashed]coordinates{(1,0) (1,1)};
\addplot [draw=none,pattern = north east lines, pattern color=red,
] coordinates {
    (0, 1.4)
    (0, 0)
    (0.5, 0)
    (0.5, 1.4)
};
  \end{axis}
 \end{tikzpicture}
\end{figure}
Anche in questo caso bisogna porre attenzione alle analisi condotte vicino lo
zero se il sistema del primo ordine è stato ottenuto come semplificazione di un
sistema  più complesso.

\subsubsection{Sistema del secondo ordine con poli complessi e coniugati}
La funzione di trasferimento ha la seguente forma
$$
W(s) = K_B \frac{1}{1+\frac{2\zeta}{\omega_n}s+\frac{s^2}{\omega_n^2}}
$$
\begin{figure}[h]
 \centering
 \begin{tikzpicture}
  \begin{axis}[
   width = 0.6\linewidth,
   axis lines = middle,
   axis equal image,
   ylabel={\Im},
   xlabel={\Re},
   xtick={-0.6,0},
   xticklabels={$\alpha$,0},
   ytick={-0.5,0.5},
   yticklabels={$-j\omega$,$j\omega$},
   y tick label style={anchor=west,xshift=0.5em},
   xlabel style={at={(ticklabel* cs:1)},anchor=north west},
   ylabel style={at={(ticklabel* cs:1)},anchor= west,},
   xmax=1,
   xmin=-1,ymax=1,ymin=-1,
   ]
   \addplot[trig format plots=rad, domain=0:2*pi,samples=100]
   ({0.9*cos(x)},
    {0.9*sin(x)});
    \draw[dashed] (-0.6,-0.5) -- (-0.6,0.5);
  \end{axis}

 \end{tikzpicture}

\end{figure}
44:14
